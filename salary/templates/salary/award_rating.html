{% extends 'salary/dashboard.html' %}
{% load salary_tags %}

{% block data %}
<div class="row justify-content-center border-top">
  <div class="col-md-12 col-sm-suto table-responsive">
    <p class="text-center mt-2">{{ title }} за {{ current_date|date:"F" }}</p>
    <table class="table table-dark verysmall">
      <thead class="text-warning text-center verysmall">
        <tr>
          <th>Сотрудник</th>
          <th>Количество смен</th>
          <th>Суммарная выручка по бару / по кальянам</th>
          <th>Средняя сумма за смену по бару / по кальяну</th>
          <th>Средняя выручка по КНА</th>
        </tr>
      </thead>
      <tbody class="text-center verysmall">
        <tr><td colspan="5" class="bg-dark bg-gradient">Кассиры</td></tr>
      {% for employee in award_data.cashiers_list %}
        {% if employee.shift_counter >= minimal_workshifts_number %}
        <tr>
          <td>{{employee.full_name}}</td>
          <td>{{employee.shift_counter}}</td>
          {% if employee.average_bar_revenue < avg_bar_criteria  %}
            <td class="text-muted">{{employee.summary_bar_revenue}}</td>
            <td class="text-muted">{{employee.average_bar_revenue}}</td>
          {% else %}
            {% if award_data.bar_leader and employee.id == award_data.bar_leader.leader.id %}
            <td class="bg-warning text-dark"><i class="fa-solid fa-award"></i>
            {% else %}
            <td>
            {% endif %}
            {{employee.summary_bar_revenue}}</td>
            <td>{{employee.average_bar_revenue}}</td>
          {% endif %}
          {% if award_data.cashiers_leader and employee.id == award_data.cashiers_leader.leader.id %}
          <td class="bg-warning text-dark"><i class="fa-solid fa-award"></i>
          {% else %}
          <td>
          {% endif %}
          {{employee.average_revenue}}</td>
        </tr>
        {% else %}
        <tr class="text-muted">
          <td>{{employee.full_name}}</td>
          <td>{{employee.shift_counter}}</td>
          <td>{{employee.summary_bar_revenue|default:"-"}}</td>
          <td>{{employee.average_bar_revenue|default:"-"}}</td>
          <td>{{employee.average_revenue}}</td>
        </tr>
        {% endif %}
      {% endfor %}
        <tr><td colspan="5" class="bg-dark bg-gradient">Админы</td></tr>
      {% for employee in award_data.hall_admin_list %}
        {% if employee.shift_counter >= minimal_workshifts_number %}
        <tr>
          <td>{{employee.full_name}}</td>
          <td>{{employee.shift_counter}}</td>
          {% if employee.average_hookah_revenue < avg_hookah_criteria %}
            <td class="text-muted">{{employee.summary_hookah_revenue|default:"-"}}</td>
            <td class="text-muted">{{employee.average_hookah_revenue}}</td>
          {% else %}
            {% if award_data.hookah_leader and employee.id == award_data.hookah_leader.leader.id %}
            <td class="bg-warning text-dark"><i class="fa-solid fa-award"></i>
            {% else %}
            <td>
            {% endif %}
            {{employee.summary_hookah_revenue|default:"-"}}</td>
            <td>{{employee.average_hookah_revenue}}</td>
          {% endif %}
          {% if award_data.hall_admins_leader and employee.id == award_data.hall_admins_leader.leader.id %}
          <td class="bg-warning text-dark"><i class="fa-solid fa-award"></i>
          {% else %}
          <td>
          {% endif %}
          {{employee.average_revenue}}</td>
        </tr>
        {% else %}
        <tr class="text-muted">
          <td>{{employee.full_name}}</td>
          <td>{{employee.shift_counter}}</td>
          <td>{{employee.summary_hookah_revenue|default:"-"}}</td>
          <td>{{employee.average_hookah_revenue|default:"-"}}</td>
          <td>{{employee.average_revenue}}</td>
        </tr>
        {% endif %}
      {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="row">
    <div class="col text-center">
      <a href="{% url 'reports_list' %}" class="btn btn-secondary verysmall">Вернуться к списку отчетов</a>
    </div>
  </div>
</div>
{% endblock %}